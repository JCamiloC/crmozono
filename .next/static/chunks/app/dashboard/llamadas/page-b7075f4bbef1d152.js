(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[501],{273:(e,t,a)=>{Promise.resolve().then(a.bind(a,3677))},3677:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var n=a(5155),s=a(2115);let l={venta:"bg-emerald-100 text-emerald-700",interesado:"bg-botanical-100 text-botanical-700",no_interesado:"bg-rose-100 text-rose-700",no_contesta:"bg-amber-100 text-amber-700",cortada:"bg-slate-200 text-slate-700",numero_incorrecto:"bg-slate-200 text-slate-700"},o={venta:"Venta efectiva",interesado:"Cliente interesado",no_interesado:"No interesado",no_contesta:"No contesta",cortada:"Llamada cortada",numero_incorrecto:"N\xfamero incorrecto"};function i(e){let{result:t}=e;return(0,n.jsx)("span",{className:"inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ".concat(l[t]),children:o[t]})}function r(e){var t;let{call:a,onRegisterResult:s}=e;return a?(0,n.jsxs)("div",{className:"flex flex-col gap-6 rounded-2xl border border-botanical-100 bg-white p-6 shadow-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Llamada"}),(0,n.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-botanical-900",children:a.leadName}),(0,n.jsx)("p",{className:"text-sm text-botanical-600",children:a.leadPhone})]}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,n.jsx)(i,{result:a.result}),(0,n.jsxs)("span",{className:"text-xs text-botanical-600",children:["Duraci\xf3n: ",a.durationMinutes," min"]})]}),(0,n.jsxs)("div",{className:"grid gap-4 text-sm text-botanical-700 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Agente"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:a.agentName})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Fecha"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:new Date(a.startedAt).toLocaleDateString()})]})]}),(0,n.jsxs)("div",{className:"rounded-2xl border border-botanical-100 bg-botanical-50 p-4 text-sm text-botanical-700",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Observaciones"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-semibold text-botanical-900",children:null!==(t=a.notes)&&void 0!==t?t:"Sin observaciones"})]}),(0,n.jsxs)("form",{className:"space-y-3",onSubmit:e=>{var t;e.preventDefault();let a=e.currentTarget,n=new FormData(a);s(n.get("result"),String(null!==(t=n.get("notes"))&&void 0!==t?t:"")),a.reset()},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Resultado"}),(0,n.jsxs)("select",{name:"result",defaultValue:a.result,className:"mt-2 w-full rounded-xl border border-botanical-100 px-3 py-2 text-sm focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100",children:[(0,n.jsx)("option",{value:"venta",children:"Venta efectiva"}),(0,n.jsx)("option",{value:"interesado",children:"Cliente interesado"}),(0,n.jsx)("option",{value:"no_interesado",children:"No interesado"}),(0,n.jsx)("option",{value:"no_contesta",children:"No contesta"}),(0,n.jsx)("option",{value:"cortada",children:"Llamada cortada"}),(0,n.jsx)("option",{value:"numero_incorrecto",children:"N\xfamero incorrecto"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Notas"}),(0,n.jsx)("textarea",{name:"notes",rows:3,className:"mt-2 w-full rounded-xl border border-botanical-100 px-3 py-2 text-sm focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100",placeholder:"Observaciones de la llamada"})]}),(0,n.jsx)("button",{type:"submit",className:"w-full rounded-xl bg-botanical-700 px-4 py-2 text-sm font-semibold text-white shadow-soft transition hover:bg-botanical-800",children:"Registrar resultado"})]})]}):(0,n.jsx)("div",{className:"rounded-2xl border border-dashed border-botanical-200 bg-white p-6 text-sm text-botanical-600",children:"Selecciona una llamada para ver detalles."})}function d(e){let{calls:t,selectedId:a,onSelect:s}=e;return(0,n.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>s(e.id),className:"flex w-full items-center justify-between gap-3 rounded-2xl border px-4 py-4 text-left transition ".concat(a===e.id?"border-botanical-200 bg-botanical-50":"border-botanical-100 bg-white hover:bg-botanical-50/70"),children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-semibold text-botanical-900",children:e.leadName}),(0,n.jsx)("p",{className:"text-xs text-botanical-600",children:e.leadPhone})]}),(0,n.jsx)(i,{result:e.result})]},e.id))})}var c=a(9965),x=a(4988);function m(){let[e,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{let e=await (0,c.O1)();t(e),e.length>0&&l(e[0].id)})()},[]);let o=(0,s.useMemo)(()=>{var t;return null!==(t=e.find(e=>e.id===a))&&void 0!==t?t:null},[e,a]),i=async(e,a)=>{if(!o)return;let n=await (0,c.fj)(o.id,e,a);t(e=>e.map(e=>e.id===n.id?n:e)),await (0,x.N)("call_result_registered","call",n.id,"Resultado registrado: ".concat(e),"Agente")};return(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-botanical-900",children:"Llamadas"}),(0,n.jsx)("p",{className:"text-sm text-botanical-600",children:"Registro de llamadas y formulario post-llamada (simulado)."})]}),(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1fr_1.6fr]",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Historial reciente"}),(0,n.jsx)(d,{calls:e,selectedId:a,onSelect:l})]}),(0,n.jsx)(r,{call:o,onRegisterResult:i})]})]})}},4988:(e,t,a)=>{"use strict";a.d(t,{N:()=>s,l:()=>l});let n=[{id:"audit-001",action:"lead_status_change",actor:"Agente CO-01",entityId:"lead-001",entityType:"lead",createdAt:new Date(Date.now()-72e5).toISOString(),summary:"Estado actualizado a Contactado"}],s=async function(e,t,a,s){let l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Sistema",o={id:"audit-".concat(Math.random().toString(36).slice(2,7)),action:e,actor:l,entityType:t,entityId:a,summary:s,createdAt:new Date().toISOString()};return n.unshift(o),o},l=async()=>[...n]},9965:(e,t,a)=>{"use strict";a.d(t,{O1:()=>s,dY:()=>l,fj:()=>o});let n=[{id:"call-001",leadId:"lead-001",leadName:"Mar\xeda Torres",leadPhone:"+57 300 123 4567",agentName:"Agente CO-01",startedAt:new Date(Date.now()-3e6).toISOString(),endedAt:new Date(Date.now()-24e5).toISOString(),durationMinutes:10,result:"interesado",notes:"Solicita m\xe1s informaci\xf3n sobre instalaci\xf3n."},{id:"call-002",leadId:"lead-002",leadName:"Jos\xe9 Mart\xednez",leadPhone:"+52 55 2345 6789",agentName:"Agente MX-03",startedAt:new Date(Date.now()-54e5).toISOString(),endedAt:new Date(Date.now()-492e4).toISOString(),durationMinutes:8,result:"no_contesta",notes:"No respondi\xf3, reintentar ma\xf1ana."},{id:"call-003",leadId:"lead-003",leadName:"Carolina R\xedos",leadPhone:"+56 9 8123 4567",agentName:"Agente CL-02",startedAt:new Date(Date.now()-9e6).toISOString(),endedAt:new Date(Date.now()-828e4).toISOString(),durationMinutes:12,result:"venta",notes:"Venta cerrada, enviar garant\xeda."}],s=async()=>[...n],l=async e=>n.filter(t=>t.leadId===e),o=async(e,t,a)=>{let s=n.find(t=>t.id===e);if(!s)throw Error("Llamada no encontrada");return s.result=t,s.notes=a,s.endedAt=new Date().toISOString(),s.durationMinutes=Math.max(1,s.durationMinutes),s}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(273)),_N_E=e.O()}]);