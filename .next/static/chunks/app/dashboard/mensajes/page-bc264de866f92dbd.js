(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{2548:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var n=a(5155),s=a(2115);let o=e=>new Date(e).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});function i(e){let{conversations:t,selectedId:a,onSelect:s}=e;return(0,n.jsx)("div",{className:"flex flex-col gap-3",children:t.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>s(e.id),className:"flex w-full items-center gap-3 rounded-2xl border px-4 py-3 text-left transition ".concat(a===e.id?"border-botanical-200 bg-botanical-50":"border-botanical-100 bg-white hover:bg-botanical-50/70"),children:[(0,n.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-botanical-200 text-xs font-semibold text-botanical-800",children:e.initials}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("p",{className:"text-sm font-semibold text-botanical-900",children:e.leadName}),(0,n.jsx)("p",{className:"text-xs text-botanical-600",children:e.lastMessage})]}),(0,n.jsx)("div",{className:"text-xs text-botanical-500",children:o(e.updatedAt)})]},e.id))})}function l(e){let{value:t,onChange:a,onSend:s}=e;return(0,n.jsxs)("div",{className:"flex items-center gap-3 rounded-2xl border border-botanical-100 bg-white p-3",children:[(0,n.jsx)("input",{value:t,onChange:e=>a(e.target.value),placeholder:"Escribe un mensaje",className:"flex-1 bg-transparent text-sm text-botanical-900 focus:outline-none"}),(0,n.jsx)("button",{type:"button",onClick:s,className:"rounded-xl bg-botanical-700 px-4 py-2 text-xs font-semibold text-white shadow-soft transition hover:bg-botanical-800",children:"Enviar"})]})}function d(e){let{messages:t}=e;return(0,n.jsx)("div",{className:"flex flex-1 flex-col gap-4 overflow-y-auto rounded-2xl border border-botanical-100 bg-white p-4",children:t.map(e=>(0,n.jsx)("div",{className:"flex ".concat("outbound"===e.direction?"justify-end":"justify-start"),children:(0,n.jsxs)("div",{className:"max-w-[70%] rounded-2xl px-4 py-3 text-sm shadow-sm ".concat("outbound"===e.direction?"bg-botanical-700 text-white":"bg-botanical-50 text-botanical-800"),children:[(0,n.jsx)("p",{children:e.body}),(0,n.jsx)("p",{className:"mt-2 text-xs opacity-70",children:new Date(e.createdAt).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})})]})},e.id))})}function r(e){let{templates:t,onSelect:a}=e;return(0,n.jsxs)("div",{className:"rounded-2xl border border-botanical-100 bg-white p-4 shadow-sm",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Plantillas aprobadas"}),(0,n.jsx)("div",{className:"mt-4 space-y-3",children:t.map(e=>(0,n.jsxs)("button",{type:"button",onClick:()=>a(e),className:"w-full rounded-xl border border-botanical-100 bg-botanical-50 px-3 py-3 text-left text-sm text-botanical-800 transition hover:bg-botanical-100",children:[(0,n.jsx)("p",{className:"font-semibold text-botanical-900",children:e.name}),(0,n.jsx)("p",{className:"text-xs text-botanical-600",children:e.preview})]},e.id))})]})}let c=[{id:"conv-001",leadId:"lead-001",leadName:"Mar\xeda Torres",leadPhone:"+57 300 123 4567",initials:"MT",lastMessage:"Gracias, esperar\xe9 el seguimiento.",updatedAt:new Date().toISOString()},{id:"conv-002",leadId:"lead-002",leadName:"Jos\xe9 Mart\xednez",leadPhone:"+52 55 2345 6789",initials:"JM",lastMessage:"\xbfMe puedes enviar la propuesta?",updatedAt:new Date(Date.now()-15e5).toISOString()},{id:"conv-003",leadId:"lead-003",leadName:"Carolina R\xedos",leadPhone:"+56 9 8123 4567",initials:"CR",lastMessage:"Listo, agendemos una llamada.",updatedAt:new Date(Date.now()-36e5).toISOString()}],u=[{id:"msg-001",conversationId:"conv-001",body:"Hola Mar\xeda, gracias por tu inter\xe9s en SuperOzono.",direction:"outbound",createdAt:new Date(Date.now()-48e5).toISOString()},{id:"msg-002",conversationId:"conv-001",body:"\xbfQuieres que te enviemos el plan de instalaci\xf3n?",direction:"outbound",createdAt:new Date(Date.now()-42e5).toISOString()},{id:"msg-003",conversationId:"conv-001",body:"Gracias, esperar\xe9 el seguimiento.",direction:"inbound",createdAt:new Date(Date.now()-36e5).toISOString()},{id:"msg-004",conversationId:"conv-002",body:"Hola Jos\xe9, te comparto la propuesta en breve.",direction:"outbound",createdAt:new Date(Date.now()-18e5).toISOString()},{id:"msg-005",conversationId:"conv-002",body:"\xbfMe puedes enviar la propuesta?",direction:"inbound",createdAt:new Date(Date.now()-15e5).toISOString()},{id:"msg-006",conversationId:"conv-003",body:"\xbfAgendamos una llamada esta semana?",direction:"outbound",createdAt:new Date(Date.now()-54e5).toISOString()},{id:"msg-007",conversationId:"conv-003",body:"Listo, agendemos una llamada.",direction:"inbound",createdAt:new Date(Date.now()-36e5).toISOString()}],m=[{id:"tpl-001",name:"Bienvenida",preview:"Hola {{nombre}}, gracias por contactarnos...",body:"Hola {{nombre}}, gracias por contactarnos en SuperOzono. \xbfEn qu\xe9 podemos ayudarte?"},{id:"tpl-002",name:"Seguimiento",preview:"Queremos saber si pudiste revisar...",body:"Hola {{nombre}}, queremos saber si pudiste revisar la propuesta. Quedamos atentos."},{id:"tpl-003",name:"Garant\xeda",preview:"Gracias por tu compra, te recordamos...",body:"Gracias por tu compra. Recuerda que tu garant\xeda est\xe1 activa y nuestro equipo te acompa\xf1a."}],x=async()=>[...c],b=async e=>u.filter(t=>t.conversationId===e),p=async(e,t)=>{let a={id:"msg-".concat(Math.random().toString(36).slice(2,7)),conversationId:e,body:t,direction:"outbound",createdAt:new Date().toISOString()};u.push(a);let n=c.find(t=>t.id===e);return n&&(n.lastMessage=t,n.updatedAt=a.createdAt),a},g=async()=>[...m];var v=a(4988);function h(){var e,t;let[a,o]=(0,s.useState)([]),[c,u]=(0,s.useState)(null),[m,h]=(0,s.useState)([]),[f,w]=(0,s.useState)([]),[S,j]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{let e=await x();o(e),e.length>0&&u(e[0].id),w(await g())})()},[]),(0,s.useEffect)(()=>{(async()=>{c&&h(await b(c))})()},[c]);let y=(0,s.useMemo)(()=>{var e;return null!==(e=a.find(e=>e.id===c))&&void 0!==e?e:null},[a,c]),N=async()=>{if(!c||!S.trim())return;let e=await p(c,S.trim());h(t=>[...t,e]),j(""),o(t=>t.map(t=>t.id===c?{...t,lastMessage:e.body,updatedAt:e.createdAt}:t)),await (0,v.N)("message_sent","conversation",c,"Mensaje enviado (simulado)","Agente")};return(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-botanical-900",children:"Mensajer\xeda"}),(0,n.jsx)("p",{className:"text-sm text-botanical-600",children:"Conversaciones activas y plantillas aprobadas (simulado)."})]}),(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1fr_2fr_1fr]",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Conversaciones"}),(0,n.jsx)(i,{conversations:a,selectedId:c,onSelect:u})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,n.jsxs)("div",{className:"rounded-2xl border border-botanical-100 bg-white p-4 shadow-sm",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Conversaci\xf3n activa"}),(0,n.jsx)("h2",{className:"mt-2 text-lg font-semibold text-botanical-900",children:null!==(e=null==y?void 0:y.leadName)&&void 0!==e?e:"Selecciona una conversaci\xf3n"}),(0,n.jsx)("p",{className:"text-xs text-botanical-600",children:null!==(t=null==y?void 0:y.leadPhone)&&void 0!==t?t:""})]}),(0,n.jsx)(d,{messages:m}),(0,n.jsx)(l,{value:S,onChange:j,onSend:N})]}),(0,n.jsx)(r,{templates:f,onSelect:e=>{j(e.body)}})]})]})}},4988:(e,t,a)=>{"use strict";a.d(t,{N:()=>s,l:()=>o});let n=[{id:"audit-001",action:"lead_status_change",actor:"Agente CO-01",entityId:"lead-001",entityType:"lead",createdAt:new Date(Date.now()-72e5).toISOString(),summary:"Estado actualizado a Contactado"}],s=async function(e,t,a,s){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Sistema",i={id:"audit-".concat(Math.random().toString(36).slice(2,7)),action:e,actor:o,entityType:t,entityId:a,summary:s,createdAt:new Date().toISOString()};return n.unshift(i),i},o=async()=>[...n]},6448:(e,t,a)=>{Promise.resolve().then(a.bind(a,2548))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(6448)),_N_E=e.O()}]);