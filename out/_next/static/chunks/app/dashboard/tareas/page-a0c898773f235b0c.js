(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[692],{3838:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>j});var n=t(5155),l=t(2115);let s={pendiente:"bg-botanical-100 text-botanical-700",completada:"bg-emerald-100 text-emerald-700",vencida:"bg-rose-100 text-rose-700",cancelada:"bg-slate-200 text-slate-700"},o={pendiente:"Pendiente",completada:"Completada",vencida:"Vencida",cancelada:"Cancelada"};function i(e){let{status:a}=e;return(0,n.jsx)("span",{className:"inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ".concat(s[a]),children:o[a]})}function r(e){let{task:a,onChangeStatus:t,onSimulateReminder:l,lastReminderNote:s,history:o}=e;return a?(0,n.jsxs)("div",{className:"flex flex-col gap-6 rounded-2xl border border-botanical-100 bg-white p-6 shadow-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Detalle de tarea"}),(0,n.jsx)("h2",{className:"mt-2 text-2xl font-semibold text-botanical-900",children:a.titulo}),(0,n.jsx)("p",{className:"text-sm text-botanical-600",children:a.leadNombre})]}),(0,n.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,n.jsx)(i,{status:a.estado}),(0,n.jsxs)("span",{className:"text-xs text-botanical-600",children:["Programada: ",new Date(a.fechaProgramada).toLocaleDateString()]})]}),(0,n.jsxs)("div",{className:"grid gap-4 text-sm text-botanical-700 sm:grid-cols-2",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Tipo de tarea"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:a.tipoTarea})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Responsable"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:a.agenteId})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Creaci\xf3n"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:new Date(a.fechaCreacion).toLocaleDateString()})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-botanical-500",children:"Estado actual"}),(0,n.jsx)("p",{className:"mt-2 font-semibold text-botanical-900",children:a.estado})]})]}),a.descripcion?(0,n.jsx)("div",{className:"rounded-2xl border border-botanical-100 bg-botanical-50 p-4 text-sm text-botanical-700",children:a.descripcion}):null,(0,n.jsxs)("div",{className:"grid gap-3",children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Cambiar estado"}),(0,n.jsxs)("select",{value:a.estado,onChange:e=>t(e.target.value),className:"rounded-xl border border-botanical-100 px-3 py-2 text-sm text-botanical-800 focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100",children:[(0,n.jsx)("option",{value:"pendiente",children:"Pendiente"}),(0,n.jsx)("option",{value:"completada",children:"Completada"}),(0,n.jsx)("option",{value:"vencida",children:"Vencida"}),(0,n.jsx)("option",{value:"cancelada",children:"Cancelada"})]})]}),(0,n.jsx)("div",{className:"rounded-2xl border border-botanical-100 bg-botanical-50 p-4 text-sm text-botanical-700",children:(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"\xdaltimo recordatorio (simulado)"}),(0,n.jsx)("p",{className:"mt-2 text-sm font-semibold text-botanical-900",children:null!=s?s:"Sin recordatorios enviados"})]}),(0,n.jsx)("button",{type:"button",onClick:l,className:"rounded-xl border border-botanical-200 bg-white px-3 py-2 text-xs font-semibold text-botanical-700 shadow-sm transition hover:bg-botanical-100",children:"Simular recordatorio"})]})}),(0,n.jsxs)("div",{className:"rounded-2xl border border-botanical-100 bg-white p-4",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Historial de estados"}),(0,n.jsx)("div",{className:"mt-3 space-y-2 text-xs text-botanical-700",children:0===o.length?(0,n.jsx)("div",{className:"rounded-xl border border-dashed border-botanical-200 bg-botanical-50 p-3 text-botanical-600",children:"Sin historial registrado."}):o.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{children:e.estado}),(0,n.jsx)("span",{className:"text-botanical-500",children:new Date(e.fecha).toLocaleDateString()})]},e.id))})]})]}):(0,n.jsx)("div",{className:"rounded-2xl border border-dashed border-botanical-200 bg-white p-6 text-sm text-botanical-600",children:"Selecciona una tarea para ver detalles."})}function d(e){let{searchValue:a,onSearchChange:t,statusValue:l,onStatusChange:s,dateValue:o,onDateChange:i}=e;return(0,n.jsxs)("div",{className:"flex flex-col gap-3 rounded-2xl border border-botanical-100 bg-white p-4 shadow-sm md:flex-row md:items-center md:justify-between",children:[(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Buscar tarea"}),(0,n.jsx)("input",{value:a,onChange:e=>t(e.target.value),placeholder:"T\xedtulo o lead",className:"w-full rounded-xl border border-botanical-100 px-3 py-2 text-sm focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100"})]}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Estado"}),(0,n.jsxs)("select",{value:l,onChange:e=>s(e.target.value),className:"w-full rounded-xl border border-botanical-100 px-3 py-2 text-sm focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100",children:[(0,n.jsx)("option",{value:"all",children:"Todos"}),(0,n.jsx)("option",{value:"pendiente",children:"Pendiente"}),(0,n.jsx)("option",{value:"completada",children:"Completada"}),(0,n.jsx)("option",{value:"vencida",children:"Vencida"}),(0,n.jsx)("option",{value:"cancelada",children:"Cancelada"})]})]}),(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,n.jsx)("label",{className:"text-xs font-semibold text-botanical-700",children:"Fecha"}),(0,n.jsxs)("select",{value:o,onChange:e=>i(e.target.value),className:"w-full rounded-xl border border-botanical-100 px-3 py-2 text-sm focus:border-botanical-400 focus:outline-none focus:ring-2 focus:ring-botanical-100",children:[(0,n.jsx)("option",{value:"all",children:"Todas"}),(0,n.jsx)("option",{value:"today",children:"Hoy"}),(0,n.jsx)("option",{value:"week",children:"Esta semana"}),(0,n.jsx)("option",{value:"overdue",children:"Vencidas"})]})]})]})}function c(e){let{tasks:a,selectedTaskId:t,onSelect:l}=e;return(0,n.jsx)("div",{className:"overflow-hidden rounded-2xl border border-botanical-100 bg-white shadow-sm",children:(0,n.jsxs)("table",{className:"w-full text-left text-sm",children:[(0,n.jsx)("thead",{className:"bg-botanical-50 text-xs uppercase tracking-[0.08em] text-botanical-600",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-4 py-3",children:"Tarea"}),(0,n.jsx)("th",{className:"px-4 py-3",children:"Estado"}),(0,n.jsx)("th",{className:"px-4 py-3",children:"Lead"}),(0,n.jsx)("th",{className:"px-4 py-3",children:"Vence"})]})}),(0,n.jsx)("tbody",{children:a.map(e=>(0,n.jsxs)("tr",{className:"cursor-pointer border-t border-botanical-100 transition hover:bg-botanical-50/70 ".concat(t===e.id?"bg-botanical-50":"bg-white"),onClick:()=>l(e.id),children:[(0,n.jsxs)("td",{className:"px-4 py-3 font-semibold text-botanical-900",children:[e.titulo,(0,n.jsx)("p",{className:"text-xs font-normal text-botanical-600",children:e.tipoTarea})]}),(0,n.jsx)("td",{className:"px-4 py-3",children:(0,n.jsx)(i,{status:e.estado})}),(0,n.jsx)("td",{className:"px-4 py-3 text-botanical-700",children:e.leadNombre}),(0,n.jsx)("td",{className:"px-4 py-3 text-botanical-700",children:new Date(e.fechaProgramada).toLocaleDateString()})]},e.id))})]})})}let x=[{id:"task-001",leadId:"lead-001",leadNombre:"Mar\xeda Torres",agenteId:"agente-co-01",titulo:"Llamar nuevamente",tipoTarea:"Llamar nuevamente",descripcion:"Cliente no respondi\xf3 en el primer contacto.",fechaProgramada:new Date(Date.now()+144e5).toISOString(),estado:"pendiente",fechaCreacion:new Date().toISOString(),fechaCompletada:null},{id:"task-002",leadId:"lead-002",leadNombre:"Jos\xe9 Mart\xednez",agenteId:"agente-mx-03",titulo:"Enviar seguimiento",tipoTarea:"Enviar mensaje de seguimiento",descripcion:"Enviar propuesta comercial por WhatsApp (simulado).",fechaProgramada:new Date(Date.now()+936e5).toISOString(),estado:"pendiente",fechaCreacion:new Date(Date.now()-72e5).toISOString(),fechaCompletada:null},{id:"task-003",leadId:"lead-003",leadNombre:"Carolina R\xedos",agenteId:"agente-cl-02",titulo:"Esperar respuesta",tipoTarea:"Esperar respuesta del cliente",descripcion:null,fechaProgramada:new Date(Date.now()-432e5).toISOString(),estado:"vencida",fechaCreacion:new Date(Date.now()-864e5).toISOString(),fechaCompletada:null},{id:"task-004",leadId:"lead-004",leadNombre:"Daniel Herrera",agenteId:"agente-pe-05",titulo:"Confirmar datos",tipoTarea:"Tarea personalizada",descripcion:"Verificar direcci\xf3n de entrega.",fechaProgramada:new Date(Date.now()+1728e5).toISOString(),estado:"completada",fechaCreacion:new Date(Date.now()-144e6).toISOString(),fechaCompletada:new Date(Date.now()-18e6).toISOString()}],m=!1,u=x.map((e,a)=>({id:"task-history-".concat(a+1),taskId:e.id,estado:e.estado,fecha:e.fechaCreacion,usuarioId:e.agenteId,comentario:"Registro inicial"})),p=async()=>(m||(x.push({id:"task-auto-001",leadId:"lead-002",leadNombre:"Jos\xe9 Mart\xednez",agenteId:"agente-mx-03",titulo:"Seguimiento por inactividad",tipoTarea:"Auto seguimiento",descripcion:"Tarea generada por inactividad simulada.",fechaProgramada:new Date(Date.now()+216e5).toISOString(),estado:"pendiente",fechaCreacion:new Date().toISOString(),fechaCompletada:null}),m=!0),[...x]),b=async(e,a)=>{let t=x.find(a=>a.id===e);if(!t)throw Error("Tarea no encontrada");return t.estado=a,t.fechaCompletada="completada"===a?new Date().toISOString():null,u.push({id:"task-history-".concat(u.length+1),taskId:e,estado:a,fecha:new Date().toISOString(),usuarioId:t.agenteId,comentario:"Estado actualizado a ".concat(a)}),t},h=async e=>u.filter(a=>a.taskId===e);var g=t(4988);let f=["Recordatorio enviado a primera hora.","Cliente solicit\xf3 posponer la llamada.","Seguimiento programado para ma\xf1ana.","Pendiente de confirmaci\xf3n del cliente."];function j(){let[e,a]=(0,l.useState)([]),[t,s]=(0,l.useState)(null),[o,i]=(0,l.useState)(""),[x,m]=(0,l.useState)("all"),[u,j]=(0,l.useState)("all"),[v,N]=(0,l.useState)(null),[w,S]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{let e=await p();a(e),e.length>0&&s(e[0].id)})()},[]),(0,l.useEffect)(()=>{(async()=>{t&&S(await h(t))})()},[t]);let C=(0,l.useMemo)(()=>{let a=new Date;return e.filter(e=>{let t=e.titulo.toLowerCase().includes(o.toLowerCase())||e.leadNombre.toLowerCase().includes(o.toLowerCase()),n="all"===x||e.estado===x,l=new Date(e.fechaProgramada),s="all"===u||"today"===u&&l.toDateString()===a.toDateString()||"week"===u&&l.getTime()<=a.getTime()+6048e5||"overdue"===u&&l<a;return t&&n&&s})},[e,o,x,u]),y=(0,l.useMemo)(()=>{var a;return null!==(a=e.find(e=>e.id===t))&&void 0!==a?a:null},[e,t]),D=async e=>{if(!y)return;let t=await b(y.id,e);a(e=>e.map(e=>e.id===t.id?t:e)),S(await h(t.id)),await (0,g.N)("task_status_change","task",t.id,"Estado de tarea actualizado a ".concat(e),"Agente")};return(0,n.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-semibold text-botanical-900",children:"Tareas"}),(0,n.jsx)("p",{className:"text-sm text-botanical-600",children:"Recordatorios y actividades comerciales por lead."})]}),(0,n.jsx)(d,{searchValue:o,onSearchChange:i,statusValue:x,onStatusChange:m,dateValue:u,onDateChange:j}),(0,n.jsxs)("div",{className:"grid gap-6 lg:grid-cols-[1.6fr_1fr]",children:[(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.2em] text-botanical-500",children:"Tareas activas"}),0===C.length?(0,n.jsx)("div",{className:"rounded-2xl border border-dashed border-botanical-200 bg-white p-6 text-sm text-botanical-600",children:"No hay tareas para los filtros actuales."}):(0,n.jsx)(c,{tasks:C,selectedTaskId:t,onSelect:s})]}),(0,n.jsx)(r,{task:y,onChangeStatus:D,onSimulateReminder:()=>{N(f[Math.floor(Math.random()*f.length)])},lastReminderNote:v,history:w})]})]})}},4988:(e,a,t)=>{"use strict";t.d(a,{N:()=>l,l:()=>s});let n=[{id:"audit-001",action:"lead_status_change",actor:"Agente CO-01",entityId:"lead-001",entityType:"lead",createdAt:new Date(Date.now()-72e5).toISOString(),summary:"Estado actualizado a Contactado"}],l=async function(e,a,t,l){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Sistema",o={id:"audit-".concat(Math.random().toString(36).slice(2,7)),action:e,actor:s,entityType:a,entityId:t,summary:l,createdAt:new Date().toISOString()};return n.unshift(o),o},s=async()=>[...n]},6540:(e,a,t)=>{Promise.resolve().then(t.bind(t,3838))}},e=>{var a=a=>e(e.s=a);e.O(0,[441,684,358],()=>a(6540)),_N_E=e.O()}]);